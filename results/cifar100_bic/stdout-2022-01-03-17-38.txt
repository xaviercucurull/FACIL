Files already downloaded and verified
Files already downloaded and verified
[(0, 25), (1, 25), (2, 25), (3, 25)]
************************************************************************************************************
Task  0
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 50 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  6.0s | Train: skip eval | Valid: time=  0.3s loss=2.634, TAw acc= 19.4% | *
| Epoch   2, time=  4.0s | Train: skip eval | Valid: time=  0.3s loss=2.406, TAw acc= 26.1% | *
| Epoch   3, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=2.400, TAw acc= 28.6% | *
| Epoch   4, time=  4.2s | Train: skip eval | Valid: time=  0.4s loss=2.302, TAw acc= 31.3% | *
| Epoch   5, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=2.061, TAw acc= 37.3% | *
| Epoch   6, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=2.074, TAw acc= 36.2% |
| Epoch   7, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=2.052, TAw acc= 38.7% | *
| Epoch   8, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.924, TAw acc= 41.0% | *
| Epoch   9, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=2.063, TAw acc= 38.6% |
| Epoch  10, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.863, TAw acc= 43.3% | *
| Epoch  11, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.848, TAw acc= 45.1% | *
| Epoch  12, time=  4.1s | Train: skip eval | Valid: time=  0.4s loss=1.798, TAw acc= 46.9% | *
| Epoch  13, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.882, TAw acc= 45.0% |
| Epoch  14, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.806, TAw acc= 46.1% |
| Epoch  15, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.695, TAw acc= 47.8% | *
| Epoch  16, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.764, TAw acc= 47.0% |
| Epoch  17, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.742, TAw acc= 50.2% |
| Epoch  18, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.651, TAw acc= 50.4% | *
| Epoch  19, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.904, TAw acc= 48.3% |
| Epoch  20, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.591, TAw acc= 51.5% | *
| Epoch  21, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.683, TAw acc= 48.2% |
| Epoch  22, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.590, TAw acc= 52.2% | *
| Epoch  23, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.960, TAw acc= 44.6% |
| Epoch  24, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.850, TAw acc= 45.4% |
| Epoch  25, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.677, TAw acc= 51.9% |
| Epoch  26, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.630, TAw acc= 53.7% |
| Epoch  27, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.476, TAw acc= 55.9% | *
| Epoch  28, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.480, TAw acc= 53.4% |
| Epoch  29, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.523, TAw acc= 55.0% |
| Epoch  30, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.464, TAw acc= 56.2% | *
| Epoch  31, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.554, TAw acc= 56.2% |
| Epoch  32, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.393, TAw acc= 59.0% | *
| Epoch  33, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.551, TAw acc= 55.8% |
| Epoch  34, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.530, TAw acc= 54.3% |
| Epoch  35, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.525, TAw acc= 54.8% |
| Epoch  36, time=  4.1s | Train: skip eval | Valid: time=  0.4s loss=1.390, TAw acc= 57.4% | *
| Epoch  37, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.347, TAw acc= 58.6% | *
| Epoch  38, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.240, TAw acc= 60.5% | *
| Epoch  39, time=  4.1s | Train: skip eval | Valid: time=  0.4s loss=1.402, TAw acc= 56.9% |
| Epoch  40, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.352, TAw acc= 59.0% |
| Epoch  41, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.448, TAw acc= 57.8% |
| Epoch  42, time=  4.1s | Train: skip eval | Valid: time=  0.4s loss=1.274, TAw acc= 61.4% |
| Epoch  43, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.585, TAw acc= 56.7% | lr=3.3e-02
| Epoch  44, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.180, TAw acc= 65.3% | *
| Epoch  45, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.177, TAw acc= 64.5% | *
| Epoch  46, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.159, TAw acc= 64.6% | *
| Epoch  47, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.217, TAw acc= 63.7% |
| Epoch  48, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.243, TAw acc= 62.2% |
| Epoch  49, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.210, TAw acc= 63.0% |
| Epoch  50, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.138, TAw acc= 65.2% | *
| Epoch  51, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.206, TAw acc= 64.2% |
| Epoch  52, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.251, TAw acc= 62.3% |
| Epoch  53, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.164, TAw acc= 64.2% |
| Epoch  54, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.169, TAw acc= 64.7% |
| Epoch  55, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.189, TAw acc= 63.8% | lr=1.1e-02
| Epoch  56, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.125, TAw acc= 66.1% | *
| Epoch  57, time=  4.0s | Train: skip eval | Valid: time=  0.3s loss=1.105, TAw acc= 66.8% | *
| Epoch  58, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.111, TAw acc= 65.8% |
| Epoch  59, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.127, TAw acc= 65.1% |
| Epoch  60, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.131, TAw acc= 65.6% |
| Epoch  61, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.143, TAw acc= 64.6% |
| Epoch  62, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.110, TAw acc= 66.8% | lr=3.7e-03
| Epoch  63, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.104, TAw acc= 66.2% | *
| Epoch  64, time=  4.1s | Train: skip eval | Valid: time=  0.4s loss=1.102, TAw acc= 66.5% | *
| Epoch  65, time=  4.2s | Train: skip eval | Valid: time=  0.4s loss=1.126, TAw acc= 65.9% |
| Epoch  66, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.111, TAw acc= 66.2% |
| Epoch  67, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.122, TAw acc= 67.0% |
| Epoch  68, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.105, TAw acc= 66.2% |
| Epoch  69, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.122, TAw acc= 65.8% | lr=1.2e-03
| Epoch  70, time=  4.0s | Train: skip eval | Valid: time=  0.3s loss=1.127, TAw acc= 65.8% |
| Epoch  71, time=  4.0s | Train: skip eval | Valid: time=  0.3s loss=1.095, TAw acc= 66.2% | *
| Epoch  72, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.107, TAw acc= 66.0% |
| Epoch  73, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.109, TAw acc= 66.4% |
| Epoch  74, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.113, TAw acc= 67.0% |
| Epoch  75, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.110, TAw acc= 66.8% |
| Epoch  76, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.101, TAw acc= 65.8% | lr=4.1e-04
| Epoch  77, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.110, TAw acc= 66.1% |
| Epoch  78, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.111, TAw acc= 65.8% |
| Epoch  79, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.107, TAw acc= 65.8% |
| Epoch  80, time=  4.2s | Train: skip eval | Valid: time=  0.4s loss=1.116, TAw acc= 66.2% |
| Epoch  81, time=  4.3s | Train: skip eval | Valid: time=  0.3s loss=1.112, TAw acc= 66.2% | lr=1.4e-04
| Epoch  82, time=  4.3s | Train: skip eval | Valid: time=  0.4s loss=1.100, TAw acc= 66.3% |
| Epoch  83, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.105, TAw acc= 66.6% |
| Epoch  84, time=  4.2s | Train: skip eval | Valid: time=  0.4s loss=1.123, TAw acc= 65.8% |
| Epoch  85, time=  4.2s | Train: skip eval | Valid: time=  0.3s loss=1.108, TAw acc= 65.8% |
| Epoch  86, time=  4.1s | Train: skip eval | Valid: time=  0.3s loss=1.115, TAw acc= 65.6% | lr=4.6e-05
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
| Selected 450 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=1.199 | TAw acc= 64.6%, forg=  0.0%| TAg acc= 64.6%, forg=  0.0% <<<
Save at ../results/cifar100_bic
************************************************************************************************************
Task  1
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 100 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.512, TAw acc= 26.8% | *
| Epoch   2, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=3.288, TAw acc= 35.2% |
| Epoch   3, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=2.517, TAw acc= 32.3% |
| Epoch   4, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=2.711, TAw acc= 33.0% |
| Epoch   5, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=2.453, TAw acc= 39.4% | *
| Epoch   6, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=2.430, TAw acc= 37.2% | *
| Epoch   7, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.991, TAw acc= 30.8% |
| Epoch   8, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.376, TAw acc= 39.8% | *
| Epoch   9, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.886, TAw acc= 33.8% |
| Epoch  10, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=6.518, TAw acc=  6.5% |
| Epoch  11, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.670, TAw acc= 34.2% |
| Epoch  12, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=2.442, TAw acc= 42.0% |
| Epoch  13, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=2.299, TAw acc= 46.5% | *
| Epoch  14, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=2.998, TAw acc= 33.3% |
| Epoch  15, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=2.364, TAw acc= 44.9% |
| Epoch  16, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.636, TAw acc= 39.6% |
| Epoch  17, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=2.284, TAw acc= 45.4% | *
| Epoch  18, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.618, TAw acc= 40.4% |
| Epoch  19, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.080, TAw acc= 55.4% | *
| Epoch  20, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.259, TAw acc= 50.0% |
| Epoch  21, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.319, TAw acc= 50.7% |
| Epoch  22, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.245, TAw acc= 49.4% |
| Epoch  23, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.632, TAw acc= 47.6% |
| Epoch  24, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.885, TAw acc= 36.2% | lr=3.3e-02
| Epoch  25, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=1.962, TAw acc= 60.4% | *
| Epoch  26, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.863, TAw acc= 63.5% | *
| Epoch  27, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.885, TAw acc= 61.9% |
| Epoch  28, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=1.868, TAw acc= 63.4% |
| Epoch  29, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.944, TAw acc= 60.2% |
| Epoch  30, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.946, TAw acc= 60.7% |
| Epoch  31, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.874, TAw acc= 63.5% | lr=1.1e-02
| Epoch  32, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=1.878, TAw acc= 62.9% |
| Epoch  33, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=1.854, TAw acc= 64.1% | *
| Epoch  34, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=1.834, TAw acc= 65.6% | *
| Epoch  35, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=1.850, TAw acc= 63.8% |
| Epoch  36, time=  5.3s | Train: skip eval | Valid: time=  0.5s loss=1.853, TAw acc= 64.2% |
| Epoch  37, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=1.820, TAw acc= 67.2% | *
| Epoch  38, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.843, TAw acc= 64.9% |
| Epoch  39, time=  5.3s | Train: skip eval | Valid: time=  0.5s loss=1.840, TAw acc= 64.2% |
| Epoch  40, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=1.840, TAw acc= 64.4% |
| Epoch  41, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=1.830, TAw acc= 65.2% |
| Epoch  42, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.828, TAw acc= 65.4% | lr=3.7e-03
| Epoch  43, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=1.841, TAw acc= 64.1% |
| Epoch  44, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=1.825, TAw acc= 66.1% |
| Epoch  45, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=1.856, TAw acc= 64.3% |
| Epoch  46, time=  5.2s | Train: skip eval | Valid: time=  0.4s loss=1.882, TAw acc= 62.8% |
| Epoch  47, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.844, TAw acc= 65.8% | lr=1.2e-03
| Epoch  48, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=1.832, TAw acc= 63.8% |
| Epoch  49, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.840, TAw acc= 64.5% |
| Epoch  50, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=1.847, TAw acc= 64.5% |
| Epoch  51, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=1.817, TAw acc= 65.4% | *
| Epoch  52, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=1.860, TAw acc= 63.7% |
| Epoch  53, time=  5.2s | Train: skip eval | Valid: time=  0.4s loss=1.828, TAw acc= 65.4% |
| Epoch  54, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.827, TAw acc= 64.9% |
| Epoch  55, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.830, TAw acc= 64.9% |
| Epoch  56, time=  5.3s | Train: skip eval | Valid: time=  0.4s loss=1.865, TAw acc= 63.0% | lr=4.1e-04
| Epoch  57, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.828, TAw acc= 64.4% |
| Epoch  58, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.825, TAw acc= 65.8% |
| Epoch  59, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.826, TAw acc= 65.4% |
| Epoch  60, time=  5.3s | Train: skip eval | Valid: time=  0.5s loss=1.853, TAw acc= 64.5% |
| Epoch  61, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=1.838, TAw acc= 64.1% | lr=1.4e-04
| Epoch  62, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=1.835, TAw acc= 63.9% |
| Epoch  63, time=  5.4s | Train: skip eval | Valid: time=  0.5s loss=1.822, TAw acc= 66.1% |
| Epoch  64, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=1.835, TAw acc= 65.1% |
| Epoch  65, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=1.833, TAw acc= 65.0% |
| Epoch  66, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=1.819, TAw acc= 66.5% | lr=4.6e-05
Stage 2: Training bias correction layers
| Epoch  50, time=  0.2s | Train: loss=2.342, TAg acc= 42.0% |
| Epoch 100, time=  0.2s | Train: loss=2.037, TAg acc= 45.0% |
| Epoch 150, time=  0.2s | Train: loss=2.106, TAg acc= 45.0% |
| Epoch 200, time=  0.2s | Train: loss=2.184, TAg acc= 47.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.78806, beta=-0.81252
| Selected 900 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.368 | TAw acc= 60.0%, forg=  4.6%| TAg acc= 36.9%, forg= 27.7% <<<
>>> Test on task  1 : loss=1.822 | TAw acc= 65.2%, forg=  0.0%| TAg acc= 62.5%, forg=  0.0% <<<
Save at ../results/cifar100_bic
************************************************************************************************************
Task  2
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 150 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.853, TAw acc= 32.0% | *
| Epoch   2, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.762, TAw acc= 41.8% | *
| Epoch   3, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.772, TAw acc= 43.3% |
| Epoch   4, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.803, TAw acc= 41.2% |
| Epoch   5, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.984, TAw acc= 45.8% |
| Epoch   6, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.724, TAw acc= 49.5% | *
| Epoch   7, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=2.824, TAw acc= 44.5% |
| Epoch   8, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.807, TAw acc= 46.6% |
| Epoch   9, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.822, TAw acc= 44.6% |
| Epoch  10, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.008, TAw acc= 38.7% |
| Epoch  11, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.683, TAw acc= 53.3% | *
| Epoch  12, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=2.665, TAw acc= 54.3% | *
| Epoch  13, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=3.126, TAw acc= 38.8% |
| Epoch  14, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.699, TAw acc= 53.8% |
| Epoch  15, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.732, TAw acc= 51.0% |
| Epoch  16, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.933, TAw acc= 43.1% |
| Epoch  17, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=2.986, TAw acc= 42.6% | lr=3.3e-02
| Epoch  18, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=2.627, TAw acc= 56.1% | *
| Epoch  19, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.600, TAw acc= 57.4% | *
| Epoch  20, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.670, TAw acc= 52.2% |
| Epoch  21, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=2.605, TAw acc= 57.3% |
| Epoch  22, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=2.585, TAw acc= 57.4% | *
| Epoch  23, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=2.661, TAw acc= 54.5% |
| Epoch  24, time=  6.0s | Train: skip eval | Valid: time=  0.5s loss=2.643, TAw acc= 55.4% |
| Epoch  25, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.617, TAw acc= 58.5% |
| Epoch  26, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.606, TAw acc= 58.4% |
| Epoch  27, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.625, TAw acc= 57.1% | lr=1.1e-02
| Epoch  28, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.579, TAw acc= 58.2% | *
| Epoch  29, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.588, TAw acc= 57.3% |
| Epoch  30, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=2.583, TAw acc= 57.8% |
| Epoch  31, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=2.571, TAw acc= 59.8% | *
| Epoch  32, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.591, TAw acc= 58.5% |
| Epoch  33, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=2.582, TAw acc= 59.0% |
| Epoch  34, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=2.582, TAw acc= 58.2% |
| Epoch  35, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.574, TAw acc= 59.6% |
| Epoch  36, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.571, TAw acc= 59.4% | *
| Epoch  37, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.568, TAw acc= 60.1% | *
| Epoch  38, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.558, TAw acc= 60.2% | *
| Epoch  39, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.575, TAw acc= 58.6% |
| Epoch  40, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.582, TAw acc= 58.1% |
| Epoch  41, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.589, TAw acc= 58.6% |
| Epoch  42, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.582, TAw acc= 58.8% |
| Epoch  43, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.571, TAw acc= 60.2% | lr=3.7e-03
| Epoch  44, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=2.568, TAw acc= 60.3% |
| Epoch  45, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=2.567, TAw acc= 59.1% |
| Epoch  46, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.571, TAw acc= 59.7% |
| Epoch  47, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=2.580, TAw acc= 59.4% |
| Epoch  48, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=2.572, TAw acc= 59.7% | lr=1.2e-03
| Epoch  49, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=2.562, TAw acc= 60.6% |
| Epoch  50, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.586, TAw acc= 58.6% |
| Epoch  51, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.569, TAw acc= 59.5% |
| Epoch  52, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.583, TAw acc= 59.3% |
| Epoch  53, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.571, TAw acc= 60.0% | lr=4.1e-04
| Epoch  54, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=2.573, TAw acc= 58.6% |
| Epoch  55, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.573, TAw acc= 59.8% |
| Epoch  56, time=  5.5s | Train: skip eval | Valid: time=  0.5s loss=2.573, TAw acc= 59.7% |
| Epoch  57, time=  5.5s | Train: skip eval | Valid: time=  0.4s loss=2.574, TAw acc= 60.2% |
| Epoch  58, time=  5.4s | Train: skip eval | Valid: time=  0.4s loss=2.572, TAw acc= 59.4% | lr=1.4e-04
| Epoch  59, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=2.572, TAw acc= 59.2% |
| Epoch  60, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=2.582, TAw acc= 58.3% |
| Epoch  61, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=2.572, TAw acc= 60.2% |
| Epoch  62, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=2.568, TAw acc= 59.8% |
| Epoch  63, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=2.590, TAw acc= 59.0% | lr=4.6e-05
Stage 2: Training bias correction layers
| Epoch  50, time=  0.2s | Train: loss=2.746, TAg acc= 31.3% |
| Epoch 100, time=  0.2s | Train: loss=2.750, TAg acc= 30.0% |
| Epoch 150, time=  0.2s | Train: loss=2.712, TAg acc= 30.7% |
| Epoch 200, time=  0.2s | Train: loss=2.714, TAg acc= 33.3% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.78806, beta=-0.81252
Stage 2: BiC training for Task 2: alpha=0.57377, beta=-0.78402
| Selected 1350 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.560 | TAw acc= 58.6%, forg=  6.0%| TAg acc= 38.4%, forg= 26.2% <<<
>>> Test on task  1 : loss=1.914 | TAw acc= 64.5%, forg=  0.7%| TAg acc= 56.6%, forg=  5.8% <<<
>>> Test on task  2 : loss=2.848 | TAw acc= 60.2%, forg=  0.0%| TAg acc= 34.1%, forg=  0.0% <<<
Save at ../results/cifar100_bic
************************************************************************************************************
Task  3
************************************************************************************************************
Stage 0: Select exemplars from validation
 > Selected 200 validation exemplars, time=  0.0s
Stage 1: Training model with distillation
| Epoch   1, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.230, TAw acc= 43.4% | *
| Epoch   2, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.191, TAw acc= 49.5% | *
| Epoch   3, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.156, TAw acc= 53.6% | *
| Epoch   4, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=3.233, TAw acc= 50.6% |
| Epoch   5, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.251, TAw acc= 49.8% |
| Epoch   6, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.144, TAw acc= 54.7% | *
| Epoch   7, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.187, TAw acc= 53.6% |
| Epoch   8, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.122, TAw acc= 59.3% | *
| Epoch   9, time=  6.0s | Train: skip eval | Valid: time=  0.5s loss=3.235, TAw acc= 53.1% |
| Epoch  10, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=3.162, TAw acc= 56.7% |
| Epoch  11, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.162, TAw acc= 56.1% |
| Epoch  12, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.542, TAw acc= 38.0% |
| Epoch  13, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=3.242, TAw acc= 55.9% | lr=3.3e-02
| Epoch  14, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.080, TAw acc= 60.7% | *
| Epoch  15, time=  6.1s | Train: skip eval | Valid: time=  0.5s loss=3.093, TAw acc= 60.0% |
| Epoch  16, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.101, TAw acc= 59.8% |
| Epoch  17, time=  5.6s | Train: skip eval | Valid: time=  0.5s loss=3.090, TAw acc= 61.0% |
| Epoch  18, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.077, TAw acc= 60.9% | *
| Epoch  19, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=3.083, TAw acc= 61.0% |
| Epoch  20, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.085, TAw acc= 60.7% |
| Epoch  21, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=3.099, TAw acc= 60.5% |
| Epoch  22, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.125, TAw acc= 58.8% |
| Epoch  23, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.089, TAw acc= 60.0% | lr=1.1e-02
| Epoch  24, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=3.077, TAw acc= 61.4% | *
| Epoch  25, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.077, TAw acc= 61.2% | *
| Epoch  26, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 61.8% | *
| Epoch  27, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 62.2% | *
| Epoch  28, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=3.069, TAw acc= 62.2% | *
| Epoch  29, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 61.6% |
| Epoch  30, time=  5.7s | Train: skip eval | Valid: time=  0.5s loss=3.079, TAw acc= 61.3% |
| Epoch  31, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.072, TAw acc= 62.5% |
| Epoch  32, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.074, TAw acc= 62.5% |
| Epoch  33, time=  5.6s | Train: skip eval | Valid: time=  0.4s loss=3.078, TAw acc= 61.8% | lr=3.7e-03
| Epoch  34, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.072, TAw acc= 61.4% |
| Epoch  35, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=3.081, TAw acc= 61.0% |
| Epoch  36, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.071, TAw acc= 62.1% |
| Epoch  37, time=  5.8s | Train: skip eval | Valid: time=  0.5s loss=3.081, TAw acc= 61.0% |
| Epoch  38, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=3.082, TAw acc= 61.7% | lr=1.2e-03
| Epoch  39, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.081, TAw acc= 61.2% |
| Epoch  40, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.073, TAw acc= 61.6% |
| Epoch  41, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.072, TAw acc= 61.8% |
| Epoch  42, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.069, TAw acc= 62.6% |
| Epoch  43, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.076, TAw acc= 62.6% | lr=4.1e-04
| Epoch  44, time=  6.0s | Train: skip eval | Valid: time=  0.5s loss=3.065, TAw acc= 62.0% | *
| Epoch  45, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.074, TAw acc= 61.8% |
| Epoch  46, time=  6.3s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 61.3% |
| Epoch  47, time=  6.0s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 61.9% |
| Epoch  48, time=  5.7s | Train: skip eval | Valid: time=  0.4s loss=3.075, TAw acc= 61.5% |
| Epoch  49, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.078, TAw acc= 60.6% | lr=1.4e-04
| Epoch  50, time=  5.9s | Train: skip eval | Valid: time=  0.4s loss=3.077, TAw acc= 61.0% |
| Epoch  51, time=  6.0s | Train: skip eval | Valid: time=  0.5s loss=3.072, TAw acc= 61.7% |
| Epoch  52, time=  5.9s | Train: skip eval | Valid: time=  0.5s loss=3.073, TAw acc= 61.8% |
| Epoch  53, time=  6.0s | Train: skip eval | Valid: time=  0.5s loss=3.082, TAw acc= 61.9% |
| Epoch  54, time=  5.8s | Train: skip eval | Valid: time=  0.4s loss=3.076, TAw acc= 60.8% | lr=4.6e-05
Stage 2: Training bias correction layers
| Epoch  50, time=  0.2s | Train: loss=2.932, TAg acc= 26.5% |
| Epoch 100, time=  0.2s | Train: loss=2.927, TAg acc= 30.5% |
| Epoch 150, time=  0.2s | Train: loss=3.077, TAg acc= 24.0% |
| Epoch 200, time=  0.2s | Train: loss=2.864, TAg acc= 26.0% |
Stage 2: BiC training for Task 0: alpha=1.00000, beta=0.00000
Stage 2: BiC training for Task 1: alpha=0.78806, beta=-0.81252
Stage 2: BiC training for Task 2: alpha=0.57377, beta=-0.78402
Stage 2: BiC training for Task 3: alpha=0.58853, beta=-0.85758
| Selected 1800 train exemplars, time=  0.0s
------------------------------------------------------------------------------------------------------------
>>> Test on task  0 : loss=2.702 | TAw acc= 59.2%, forg=  5.4%| TAg acc= 38.7%, forg= 25.9% <<<
>>> Test on task  1 : loss=2.072 | TAw acc= 65.0%, forg=  0.2%| TAg acc= 52.7%, forg=  9.8% <<<
>>> Test on task  2 : loss=2.892 | TAw acc= 58.5%, forg=  1.6%| TAg acc= 28.5%, forg=  5.6% <<<
>>> Test on task  3 : loss=3.321 | TAw acc= 62.2%, forg=  0.0%| TAg acc= 26.6%, forg=  0.0% <<<
Save at ../results/cifar100_bic
************************************************************************************************************
TAw Acc
	 64.6%   0.0%   0.0%   0.0% 	Avg.: 64.6% 
	 60.0%  65.2%   0.0%   0.0% 	Avg.: 62.6% 
	 58.6%  64.5%  60.2%   0.0% 	Avg.: 61.1% 
	 59.2%  65.0%  58.5%  62.2% 	Avg.: 61.2% 
************************************************************************************************************
TAg Acc
	 64.6%   0.0%   0.0%   0.0% 	Avg.: 64.6% 
	 36.9%  62.5%   0.0%   0.0% 	Avg.: 49.7% 
	 38.4%  56.6%  34.1%   0.0% 	Avg.: 43.1% 
	 38.7%  52.7%  28.5%  26.6% 	Avg.: 36.6% 
************************************************************************************************************
TAw Forg
	  0.0%   0.0%   0.0%   0.0% 
	  4.6%   0.0%   0.0%   0.0% 	Avg.:  4.6% 
	  6.0%   0.7%   0.0%   0.0% 	Avg.:  3.4% 
	  5.4%   0.2%   1.6%   0.0% 	Avg.:  2.4% 
************************************************************************************************************
TAg Forg
	  0.0%   0.0%   0.0%   0.0% 
	 27.7%   0.0%   0.0%   0.0% 	Avg.: 27.7% 
	 26.2%   5.8%   0.0%   0.0% 	Avg.: 16.0% 
	 25.9%   9.8%   5.6%   0.0% 	Avg.: 13.7% 
************************************************************************************************************
[Elapsed time = 0.4 h]
Done!
